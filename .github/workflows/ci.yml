# 1 워크플로의 이름 지정
name: Django CI

# 2 워크플로가 시작될 조건 지정
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build:
    # 3. 실행 환경 지정
    runs-on: ubuntu-latest
    strategy:
      # max-parallel: 4는 Github Actions에서 제공하는 기본 파일의 설정
      max-parallel: 4
      matrix:
        python-version: [3.11]
    # 4. 실행 스템 지정
    steps:
    - uses: actions/checkout@v3

    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v3
      with:
        python-version: ${{ matrix.python-version }}

#    - name: create-json
#      id: create-json
#      uses: jsdaniell/create-json@1.1.2
#      with:
#        name: "secrets.json"
#        json: ${{ secrets.SECERT_JSON }}

    - name: Install Dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements_bk.txt

    - name: Run Tests
      run: |
        python manage.py test

    - name: excuting remote ssh commands to deploy
      uses: appleboy/ssh-action@master
      with:
#        host: ${{ secrets.REMOTE_SSH_HOST }}
#        port: ${{ secrets.REMOTE_SSH_PORT }}
#        username: ${{ secrets.REMOTE_SSH_USERNAME }}
#        password: ${{ secrets.REMOTE_SSH_PASSWORD }}
#        key: ${{ secrets.REMOTE_SSH_KEY }}
        host: "192.168.0.16"
        port: "2022"
        username: "agics-ai"
        password: "agics12!@"
        key: "-----BEGIN OPENSSH PRIVATE KEY-----
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
-----END OPENSSH PRIVATE KEY-----"
        debug: true
#        key_path: "/home/agics-ai/.ssh/id_rsa"
        scripts: whoami
